<!DOCTYPE html>
<html>
<head>
  <title>ESP32 Heater Control</title>
</head>
<body>
  <h1>Heater Control</h1>
  <button onclick="sendCommand('ON')">Turn ON</button>
  <button onclick="sendCommand('OFF')">Turn OFF</button>
  <p>Status: <span id="status">Unknown</span></p>

  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
  <script>
    const broker = "wss://test.mosquitto.org:8081";
    const commandTopic = "drm-pelanet/aquecimento/command";
    const statusTopic  = "drm-pelanet/aquecimento/status";

    const client = mqtt.connect(broker);

    client.on('connect', () => {
      console.log("Connected to MQTT broker");
      client.subscribe(statusTopic);
    });

    client.on('message', (topic, message) => {
      if (topic === statusTopic) {
        document.getElementById("status").innerText = message.toString();
      }
    });

    function sendCommand(cmd) {
      client.publish(commandTopic, cmd);
    }
  </script>
</body>
</html>